+++
title = '240823'
date = 2024-08-23T10:27:41+09:00
draft = false
+++

## Terraform Code Gen 관련 사항 정리

목표는 다음과 같다.

`provider-code-spec.json` 파일 정의를 통해 실제 terraform provider code 생성이 가능하도록 workflow 구축.

기존의 [example.json](https://github.com/hashicorp/terraform-plugin-codegen-spec/blob/main/spec/v0.1/example.json)을 살펴보자.

### Data Source Gen

지금 나는 Object Storage 관련한 Data source 작업들을 진행하고 있으므로, 해당 작업을 예시로 진행한다.
기존 소스를 `terraform-plugin-codegen-framework` 를 활용해서 생성한 뒤, 해당 파일에서 원하는 Attr 만 추출하여 미리 작성해둔 go template에 주입해준다.
외부에서 이를 어떻게 사용할지 고민 중인데, 자동화를 위해서는 Actions에 태우는 것도 방법일 것 같다.

### Go Template

Data Source의 경우 많은 로직을 담고 있는 것은 아니기 때문에, PoC를 적용하기 좋은 요소라고 생각하여 진행한다.
실제 Template에 데이터를 주입하는 코드는 추후 소개한다.