+++
title = 'Network 1'
date = 2024-09-07T22:15:55+09:00
draft = false
+++

### 프로토콜 스택에서 이더넷부터의 동작

프로토콜 스택에서 이더넷 프레임은 48비트 목적지 주소와 16비트 이더넷 유형 필드를 포함하는데, 이 목적지 주소는 링크 계층 주소 또는 MAC주소라고 불린다.

이더넷 유형 필드 값 중에 (16진법 기준) 0x0800 은 IPv4, 0x0806은 ARP, 0x86DD는 IPv6를 표시하는 표시자가 된다. MAC 주소가 일치한다면 이후 이더넷 유형 필드를 확인하여 알맞는 3계층 프로토콜이 처리할 수 있도록 돕는다.

### 3계층 동작

데이터그램 안의 IP주소 등 항목을 검사한다. 이후 본인 주소와 일치하고 데이터그램의 헤더에 오류가 없을 경우, 8비트 IPv4 프로토콜 필드 (IPv6에서는 Next protocol field)를 사용하여 어떤 프로토콜을 호출해야하는지 결정한다.

> 여기서 중요하게 다가오는 것은 해당 필드에 IPv4있 나타내는 4 가 나타날 수 있다는 점이다.
> 이 값은 IP 데이터그램의 페이로드 영역 내에 다시금 IP 데이터그램이 존재할 수 있다는 것을 의미한다.
> 이는 추후 얘기되는 터널링을 가능하게 만드는 작업이 된다.

### 4계층 동작

4계층에서는 3계층에서의 주소 기반 역다중화와 비슷하게 포트 기반 역다중화를 활용한다.
이는 기존 호스트 - 호스트 기반 애플리케이션 통신 구조를 타파하고 프로세스 - 프로세스 기반 통신 구조를 만드는 기반이 된다(라고 교수님이 엄청 말하셨다).

표준 포트 번호를 지정하는 기구는 IANA다. 포트 번호들은 몇 개의 특별한 범위들로 구분된다.

> 0~1023 => well-known port
> 1024~49151 => registered port
> 49152~65535 => dynamic/private port

기본적인 well-known port의 경우 이곳에서 서비스를 제공하려면 관리자 혹은 root 권한을 가진 채 접근해야한다.

### DNS

IP 는 4 개의 숫자로 구성된 하나의 조합이다. 사람들이 각자 접근하고자 하는 사이트의 숫자 4개를 전부 기억할 수 없는 노릇이기 때문에, 우리는 DNS를 만들어 활용한다.
여기서 흥미로운 점이 있다면 DNS는 7계층의 프로토콜인데, 동작하기 위해 다른 프로토콜들에 의존하게 된다.

DNS는 동작을 위해 3, 4계층의 프로토콜을 다음과 같은 방식으로 활용한다.

> DNS는 주로 UDP 포트 53을 사용해 요청과 응답을 처리한다.
> 때로는 TCP를 사용하기도 한다. 특히 대형 DNS응답이나 연결의 신뢰성을 보장해야하는 경우 TCP를 사용하고 있다.
> DNS요청과 응답 전반에서 IP가 사용된다(사실 통신하는거라 당연한 말. 하드웨어 계층은 굳이 언급하지 않는 듯).